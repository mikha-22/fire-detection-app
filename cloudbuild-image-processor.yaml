# cloudbuild-image-processor.yaml
steps:
- name: 'gcr.io/cloud-builders/gcloud'
  # ... (entrypoint and args -c are unchanged) ...

- name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
  entrypoint: 'gcloud'
  args:
  - 'functions'
  - 'deploy'
  - 'ImageProcessorCF'
  - '--gen2'
  # ... (other args are unchanged) ...
  - '--set-env-vars=GCP_PROJECT_ID=haryo-kebakaran,GCP_REGION=asia-southeast2,GCS_BUCKET_NAME=fire-app-bucket,VERTEX_AI_OBJECT_DETECTION_MODEL=wildfire-cpr-predictor-model'
  - '--timeout=540s'
  - '--memory=2GiB'
  - '--project=haryo-kebakaran'
  # --- ADD THIS LINE ---
  - '--allow-unauthenticated'

options:
  logging: CLOUD_LOGGING_ONLY
timeout: '1200s'
